================================================================================
ROAMPAL-CORE v0.3.2 TEST RESULTS SUMMARY
================================================================================
Date: 2025-12-15 (updated 2026-02-06)

UNIT TESTS
----------
Result: 457/457 PASSED (100%)
File: unit_tests.txt

INTEGRATION TESTS (verified 2026-02-03)
----------------------------------------
Comprehensive Test:  31/31 PASSED (100%)
  - v0.3.2: Fixed 10 API mismatches (record_outcome args, doc ID format,
    content_graph access, promotion thresholds, decay methods)
  - Added: cross-collection search test, history 30d cleanup test
  - All 7 categories: storage, retrieval, scoring, promotion, KG, tiers, edge cases
Torture Suite:       10/10 PASSED (100%)
  - High volume (1000 stores), adversarial dedup, score boundaries,
    cross-collection, routing convergence, promotion, capacity,
    KG integrity, concurrent access

INTEGRATION TESTS - MOCK EMBEDDINGS (moved to dev/tests/integration/)
----------------------------------------------------------------------
1. Contradictions:           4/5 PASS (80%) - Test 4 Confidence Conflict FAIL
2. Semantic Confusion:       3/5 PASS (60% - truth #1)
3. Latency:                  ALL SIZES PASS (p50 ~40ms)
4. Stale Data:               1/1 PASS
5. Edge Cases:               23/24 (96%) - SQL injection test FAIL
6. Context Poisoning:        5/5 PASS (100%)
7. Catastrophic Forgetting:  5/5 PASS (100%)
8. Recovery Resilience:      6/6 PASS (100%)
9. Learning Sabotage:        10/10 PASS (100%)
10. Search Quality:          100% (all metrics)
11. Learning Speed:          90% avg (Grade A - Excellent)
    - Cold Start: 100%
    - Learning Curve: 100%
    - Adaptation Speed: 90%
    - Pattern Recognition: 100%
    - Knowledge Retention: 75%
    - Context Specialization: 67%
    - Learning Efficiency: 100%

BENCHMARKS - REAL EMBEDDINGS (all-mpnet-base-v2, re-run 2026-02-06)
---------------------------------------------------------------------
NOTE: All benchmarks re-run with consistent metadata setup (success_count,
uses, score, outcome_history set together). Uses SearchService + Wilson
scoring + CE bypass for scored memories (uses >= 3).

12. Token Efficiency:        100 adversarial scenarios
    - vs RAG Top-3: 71% fewer tokens (54 -> 16 tokens/query)
    - vs RAG Top-5: 83% fewer tokens (93 -> 16 tokens/query)
    - Hit@1: RAG 1%, Roampal 0% (all near-zero on adversarial queries)
    - Token reduction is structural (limit=1 vs limit=3/5), not quality-driven

13. Learning Curve:          50 tests (10 scenarios x 5 maturity levels)
    - Cold Start: 20% -> Early: 20% -> Established: 30% -> Proven: 60% -> Mature: 100%
    - Improvement: +80 percentage points (20% -> 100%)
    - All 5 domains 100% at mature level
    - Gradual improvement curve validates Wilson + dynamic weights

14. Roampal vs Vector DB:   30 adversarial scenarios
    - Roampal: 40% (12/30) vs Vector DB: 0% (0/30)
    - p = 0.000135 (highly significant)
    - Cohen's d: 1.14 (LARGE effect)
    - 95% CI: [21.4%, 58.6%]

15. Outcome A/B Test:        10 adversarial scenarios
    - WITH outcomes: 30% (3/10)
    - WITHOUT outcomes: 0% (0/10)
    - Cohen's d: 0.88 (LARGE effect), p = 0.081 (trending, n=10 too small)

16. Comprehensive 4-Way:    200 tests (10 scenarios x 5 maturity x 4 conditions)
    - RAG Baseline:  10% Top-1, 0.550 MRR, 0.668 nDCG@5, 40 tok
    - Reranker Only: 20% Top-1, 0.600 MRR, 0.705 nDCG@5, 90 tok
    - Outcomes Only: 50% Top-1, 0.750 MRR, 0.815 nDCG@5, 40 tok
    - Full Roampal:  42% Top-1, 0.710 MRR, 0.786 nDCG@5, 40 tok
    - At mature level: Full Roampal matches Outcomes Only at 60%
      (CE bypass working — no more undercutting Wilson for scored memories)
    - Learning: Cold 10% -> Early 40% -> Established 50% -> Mature 60%
    - Cross-domain: 100% train, 0% unseen (by design)
    - Stats: McNemar p=0.0625, Paired t(MRR) p=0.015*

17. Dynamic Weight Shift:   5 scenarios
    - 4/5 passed (80%)
    - FAIL: "Failed Advice Should Sink" — failed memory (score 0.2)
      still ranks #1 due to semantic similarity overwhelming penalty

DESKTOP COMPARISON (read-only, not edited)
------------------------------------------
- Roampal vs Vector DB: Core 40% vs Desktop 86.7% (v0.3.0)
- 4-Way Full Roampal:   Core 42% vs Desktop 44% (v0.2.6)
- Learning Curve:        Both reach 100% at mature level
- Token Efficiency:      Core 0% accuracy vs Desktop 96% accuracy
  (Both use SearchService; adversarial benchmark Hit@1 is near-zero
   by design — real-world accuracy differs)

================================================================================
OVERALL: All benchmarks run with correct 768d embedding model, SearchService
(hybrid search + BM25), cross-encoder reranking, Wilson scoring, and consistent
metadata setup (success_count aligned with uses).

Key findings:
1. Outcome learning dominates: +50 pts at mature vs +10 pts for reranker (5x)
2. CE bypass works: Full Roampal = Outcomes Only at mature level (60%)
3. Gradual learning curve: 10% -> 40% -> 50% -> 50% -> 60% (Wilson validated)
4. All tests statistically significant where n is sufficient (p < 0.001 for
   vs-vector-db n=30, p=0.015 for 4-way MRR)
================================================================================
